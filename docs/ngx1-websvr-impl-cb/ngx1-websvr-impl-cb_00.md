# 前言

Nginx 是一个开源的高性能 Web 服务器，最近受到了相当大的关注。由于其模块化架构和小巧的体积，它已经成为许多小型 Web 2.0 公司作为负载均衡代理服务器的默认选择。它支持大多数现有的后端 Web 协议，如 FCGI、WSGI 和 SCGI。如果你想深入了解 Nginx 服务器，本书非常适合你。

*Nginx 1 Web 服务器实现食谱*涵盖了所有有助于你在使用 Nginx Web 服务器时设置高效 Web 应用程序的技术。从一些鲜为人知的 Nginx 应用（如邮件代理服务器、视频文件流媒体、图像动态调整大小等）到更常见的用法，本书都有详细的食谱。

本书的第一章涵盖了对任何开始使用 Nginx 的人来说都非常有用的基础知识。每个食谱都设计为彼此独立。

本书涵盖了广泛的领域，如核心、日志、重写、安全等。我们将探讨如何优化 Nginx 设置，设置你的 WordPress 博客，阻止在你网站上发布垃圾信息的机器人，使用 munin 设置监控等等。

*Nginx 1 Web 服务器实现食谱*通过逐步的食谱，帮助你轻松进入 Nginx 世界，完成几乎所有运行自己 Web 应用程序所需的任务。

这是一本面向系统管理员和 Web 开发人员的实用指南，帮助你最大限度地发挥开源 Nginx Web 服务器的优势。

# 本书的内容

第一章，*核心 HTTP 模块*，处理 Nginx 配置和实现的基础知识。到本章结束时，你应该能够在机器上编译 Nginx，创建虚拟主机，设置用户跟踪，并使 PHP 正常工作。

第二章，*关于重写的一切：重写模块*，专门讲解重写模块；它将教你基本知识，并且能够让你配置各种常用的 Web 开发框架，使其与 Nginx 设置正确配合，使用正确的重写规则。

第三章，*日志记录一切：日志模块*，旨在教你 Nginx 日志模块的基本配置以及高级配置，如日志管理、备份、轮换等。日志记录非常关键，因为它有助于你识别和追踪应用程序的各种属性，如性能、用户行为等。它还可以帮助你作为系统管理员，反应性和主动性地识别潜在的安全问题。

第四章，*减缓它们的速度：访问和速率限制模块*，解释了 Nginx 如何通过提供基于 IP 的速率限制和服务器访问来有效防止网站被摧毁等问题。

第五章，*让我们变得更安全：安全模块*，讲述了如何使用 Nginx 内置的安全模块来保护您的网站和用户数据。

第六章，*设置应用程序：FCGI 和 WSGI 模块*，专门介绍如何帮助程序员和系统管理员理解并使用 Nginx 作为 Web 服务器来安装他们的应用程序。由于缺乏集成模块来运行 PHP 和 Python，设置这些系统对没有经验的系统管理员来说可能是一个问题。

第七章，*Nginx 作为反向代理*，讲解了如何在各种常见场景中使用 Nginx 作为反向代理。我们将查看如何设置 Rails 应用，如何设置负载均衡，并且还会探讨使用 Nginx 配置缓存的设置，这可能会在不修改代码库的情况下提高现有网站的性能。

第八章，*使用 Nginx 提升性能和 SEO*，主要讲解如何使您的网站加载更快，并可能带来更多流量。我们将介绍优化 Nginx 设置的基础知识以及一些 SEO 技巧。这些技巧不仅对您的 SEO 有帮助，而且对网站和应用程序的整体健康也有益。

第九章，*使用其他第三方模块*，讲述了一些内置和第三方模块，它们允许我们扩展和使用 Nginx 与其他协议（如 IMAP、POP3、WebDAV 等）进行互动。由于灵活且良好定义的模块 API，许多模块开发者已经使用 Nginx 处理一些有趣的基于 Web 的任务，如 XSLT 转换、图像缩放和 HTTP 发布-订阅服务器。

第十章，*更多的第三方模块*，探讨了各种 Web 场景，如负载均衡、服务器健康检查等，这些在生产环境中非常有用。这些简单的食谱在企业场景中应用广泛，特别是当您需要分析、外部认证方案和其他多种情况时。

# 本书所需的内容

在理解方面，具备一些 Web 服务器管理经验会有所帮助。如果您理解一个基本网站的工作原理，那么理解一些更面向生产环境的配置将会更容易。查看食谱索引可以帮助您快速了解各个主题，并且一目了然地看到全书的内容互联。

本书中的所有代码都已经在以下软件环境中进行了测试

1.  Ubuntu/Debian Linux，内核版本为 2.6.x

1.  Nginx 版本从 0.7.x+到 1.0.0

1.  安装的 Nginx 编译器依赖

Nginx 二进制文件也可以用于 Windows，但要编译模块，使用基于 Cygwin 的设置会更容易。

可能需要一些耐心和阅读，才能更有效地利用书中所学到的知识。祝你玩得开心，尽情‘Nginx’ing！

# 本书适合谁阅读

如果你厌倦了 Apache 在流量很少时消耗你所有的服务器内存，或者由于其他原因你正在寻找一个高性能的负载均衡代理服务器并且尝试过使用 Nginx，那么这本书适合你。你需要一些基本的 Nginx 知识。本书将对系统管理员和网页开发人员大有裨益。

# 约定

本书中，你会看到多种文本风格，区分不同类型的信息。以下是这些风格的示例及其含义说明。

文本中的代码词汇显示如下：“我们可以通过使用 `include` 指令包含其他上下文。”

代码块如下所示：

```
int main()
{
// Open the video file
cv::VideoCapture capture("../bike.avi");
// check if video successfully opened
if (!capture.isOpened())
return 1;

```

当我们希望特别强调代码块中的某个部分时，相关的行或项会以粗体显示：

```
server 192.168.1.3;
server 192.168.1.5;
fair;
}
server {

```

任何命令行输入或输出都如下所示：

```
/etc/init.d/nginx restart

```

**新术语** 和 **重要单词** 以粗体显示。你在屏幕上看到的、出现在菜单或对话框中的文字也会以这种方式显示：“点击 **下一步** 按钮将带你进入下一个屏幕”。

### 注意

警告或重要提示会以类似这样的框框显示。

### 小贴士

小窍门和技巧以这种方式出现。

# 读者反馈

我们始终欢迎读者的反馈。告诉我们你对这本书的看法——你喜欢的部分或不喜欢的地方。读者反馈对我们开发让你真正受益的书籍非常重要。

要向我们发送一般反馈，只需发送电子邮件至 `<feedback@packtpub.com>`，并在邮件主题中提及书名。

如果你需要一本书并希望我们出版，请通过 [www.packtpub.com](http://www.packtpub.com) 上的 **建议书名** 表格发送信息，或者发送电子邮件至 `<suggest@packtpub.com>`。

如果你在某个领域有专业知识并且有兴趣撰写或贡献书籍，请参阅我们在 [www.packtpub.com/authors](http://www.packtpub.com/authors) 上的作者指南。

# 客户支持

现在，作为骄傲的 Packt 书籍拥有者，我们为你提供了多种方式，帮助你最大化购买的价值。

## 下载示例代码

你可以从 [`www.PacktPub.com`](http://www.PacktPub.com) 你的账户中下载所有购买的 Packt 书籍的示例代码文件。如果你在其他地方购买了本书，可以访问 [`www.PacktPub.com/support`](http://www.PacktPub.com/support)，并注册以直接将文件通过电子邮件发送给你。

## 勘误

虽然我们已经尽最大努力确保内容的准确性，但错误仍然有可能发生。如果您在我们的书籍中发现错误——可能是文本或代码的错误——我们将非常感激您能报告给我们。这样，您可以帮助其他读者避免困扰，同时也能帮助我们改进后续版本的内容。如果您发现任何勘误，请访问[`www.packtpub.com/support`](http://www.packtpub.com/support)报告，选择您的书籍，点击**勘误提交表单**链接，填写勘误的详细信息。一旦您的勘误被验证，您的提交将被接受，勘误将被上传至我们的网站，或添加到该书籍的现有勘误列表中，显示在该书籍的勘误部分。任何现有的勘误可以通过在[`www.packtpub.com/support`](http://www.packtpub.com/support)选择您的书籍标题查看。

## 盗版

网络盗版问题在所有媒体中普遍存在，且一直在持续增长。在 Packt，我们非常重视对版权和许可证的保护。如果您在互联网上发现任何形式的非法盗版内容，请立即向我们提供相关网址或网站名称，以便我们采取措施。

如果您发现涉嫌盗版的内容，请通过 `<copyright@packtpub.com>` 联系我们，并附上盗版材料的链接。

我们感谢您在保护我们作者权益方面的帮助，也感谢您支持我们提供有价值内容的能力。

## 问题

如果您在使用本书时遇到任何问题，请通过 `<questions@packtpub.com>` 联系我们，我们会尽力解决您的问题。
