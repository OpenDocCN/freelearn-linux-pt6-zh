<html><head></head><body>
<div id="_idContainer014">
<h1 class="chapter-number" id="_idParaDest-15"><a id="_idTextAnchor014"/><span class="koboSpan" id="kobo.1.1">1</span></h1>
<h1 id="_idParaDest-16"><a id="_idTextAnchor015"/><span class="koboSpan" id="kobo.2.1">Downloading and Installing NGINX</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.3.1">NGINX</span></strong><span class="koboSpan" id="kobo.4.1"> (pronounced </span><em class="italic"><span class="koboSpan" id="kobo.5.1">engine-x</span></em><span class="koboSpan" id="kobo.6.1">) has become the leader among web servers ever since it came out 20 years ago. </span><span class="koboSpan" id="kobo.6.2">Back in 2004, its main goal was to outperform Apache, and today, NGINX </span><a id="_idIndexMarker000"/><span class="koboSpan" id="kobo.7.1">is outperforming every web server when it comes to high-traffic websites or security. </span><span class="koboSpan" id="kobo.7.2">Throughout this book, we will discover and learn how to use NGINX, step by step. </span><span class="koboSpan" id="kobo.7.3">We will cover many subjects to have a configuration tailored to </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">everyone’s needs.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">In this first chapter, we will proceed with the necessary steps toward establishing a functional setup of NGINX. </span><span class="koboSpan" id="kobo.9.2">This moment is crucial for the smooth functioning of your web server—there are some required libraries and tools for installing the web server, some parameters that you will have to decide upon when compiling the binaries, and there may also be some configuration changes to perform on </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">your system.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">By the end of this chapter, you will have installed NGINX either through a public repository or by compiling a custom version embedding all the extra modules you </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">might need.</span></span></p>
<p><span class="koboSpan" id="kobo.13.1">This chapter covers </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.15.1">Installing NGINX via </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">package managers</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Downloading and installing the prerequisites for compiling </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">NGINX binaries</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Downloading a suitable version of the NGINX </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">source code</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Configuring NGINX </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">compile-time options</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Controlling the application with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.24.1">unit </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.25.1">service</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.26.1"> file</span></span></li>
<li><span class="koboSpan" id="kobo.27.1">Configuring the system to launch NGINX automatically </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">on startup</span></span></li>
<li><span class="koboSpan" id="kobo.29.1">A quick overview of the possibilities offered by </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">NGINX Plus</span></span><a id="_idTextAnchor016"/></li>
</ul>
<p><span class="koboSpan" id="kobo.31.1">…</span><a id="_idTextAnchor017"/></p>
<h1 id="_idParaDest-17"><a id="_idTextAnchor018"/><span class="koboSpan" id="kobo.32.1">Installing NGINX via package managers</span></h1>
<p><span class="koboSpan" id="kobo.33.1">The quickest, and easiest, way </span><a id="_idIndexMarker001"/><span class="koboSpan" id="kobo.34.1">to install NGINX is to simply use your OS-provided version. </span><span class="koboSpan" id="kobo.34.2">Most of the time, these are kept fairly updated; however, for some Linux distributions focusing on stability, you may only have older versions of NGINX available. </span><span class="koboSpan" id="kobo.34.3">Sometimes, your Linux distribution may provide multiple versions of NGINX with different </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">compile flags.</span></span></p>
<p><span class="koboSpan" id="kobo.36.1">In general, before embarking on a more complex journey, we should check whether we can use the easy solution. </span><span class="koboSpan" id="kobo.36.2">For Red Hat Linux-based operating systems, we need to enable the EPEL repo first and then do </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">the same:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.38.1">
yum install epel-release
yum search nginx
yum info PACKAGE_NAME
yum install PACKAGE_NAME</span></pre> <p><span class="koboSpan" id="kobo.39.1">For a Debian-based operating system, we first find the NGINX compiles available and then get the information for the one </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">we want:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.41.1">
apt-cache search nginx
apt-cache show PACKAGE_NAME
apt install PACKAGE_NAME</span></pre> <p><span class="koboSpan" id="kobo.42.1">If the version provided is current enough, then you’re ready to configure NGINX in the </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">next chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.44.1">If the version provided by your distribution is too old, then</span><a id="_idIndexMarker002"/><span class="koboSpan" id="kobo.45.1"> NGINX provides packages for </span><strong class="bold"><span class="koboSpan" id="kobo.46.1">RHEL/CentOS distributions</span></strong><span class="koboSpan" id="kobo.47.1"> as well as </span><strong class="bold"><span class="koboSpan" id="kobo.48.1">Debian/Ubuntu distributions</span></strong><span class="koboSpan" id="kobo.49.1">. </span><span class="koboSpan" id="kobo.49.2">We encourage you to</span><a id="_idIndexMarker003"/><span class="koboSpan" id="kobo.50.1"> visit the official NGINX website to make sure the version given by your distribution </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">isn’t outda</span><a id="_idTextAnchor019"/><span class="koboSpan" id="kobo.52.1">t</span><a id="_idTextAnchor020"/><span class="koboSpan" id="kobo.53.1">ed.</span></span></p>
<h2 id="_idParaDest-18"><a id="_idTextAnchor021"/><span class="koboSpan" id="kobo.54.1">NGINX-provided packages</span></h2>
<p><span class="koboSpan" id="kobo.55.1">To </span><a id="_idIndexMarker004"/><span class="koboSpan" id="kobo.56.1">set up a </span><strong class="source-inline"><span class="koboSpan" id="kobo.57.1">yum</span></strong><span class="koboSpan" id="kobo.58.1"> repository for RHEL/CentOS, create a file named </span><strong class="source-inline"><span class="koboSpan" id="kobo.59.1">/etc/yum.repos.d/nginx.repo</span></strong><span class="koboSpan" id="kobo.60.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">following contents:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.62.1">
[nginx]
name=nginx repo
baseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/
gpgcheck=0
enabled=1</span></pre> <p><span class="koboSpan" id="kobo.63.1">Replace </span><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">OS</span></strong><span class="koboSpan" id="kobo.65.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.66.1">rhel</span></strong><span class="koboSpan" id="kobo.67.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.68.1">centos</span></strong><span class="koboSpan" id="kobo.69.1">, depending on the distribution used, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.70.1">OSRELEASE</span></strong><span class="koboSpan" id="kobo.71.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.72.1">8</span></strong><span class="koboSpan" id="kobo.73.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.74.1">9</span></strong><span class="koboSpan" id="kobo.75.1">, for versions 8.x or 9.x, respectively. </span><span class="koboSpan" id="kobo.75.2">Afterward, NGINX can now be installed </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.77.1">yum</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.79.1">
yum install nginx</span></pre> <p><span class="koboSpan" id="kobo.80.1">For Debian-based </span><a id="_idIndexMarker005"/><span class="koboSpan" id="kobo.81.1">distributions, we need to first use their signing key to authenticate the package signatures. </span><span class="koboSpan" id="kobo.81.2">Download the following file first </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">from </span></span><a href="http://nginx.org/keys/nginx_signing.key"><span class="No-Break"><span class="koboSpan" id="kobo.83.1">http://nginx.org/keys/nginx_signing.key</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.84.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.85.1">Then, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.87.1">
sudo apt-key add nginx_signing.key</span></pre> <p><span class="koboSpan" id="kobo.88.1">With the key added, we can now add the NGINX repository to </span><strong class="source-inline"><span class="koboSpan" id="kobo.89.1">sources.list</span></strong><span class="koboSpan" id="kobo.90.1"> found in </span><strong class="source-inline"><span class="koboSpan" id="kobo.91.1">/etc/apt/sources.list</span></strong><span class="koboSpan" id="kobo.92.1">. </span><span class="koboSpan" id="kobo.92.2">For Debian, we add the </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">following lines:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.94.1">
deb http://nginx.org/packages/debian/ codename nginx
deb-src http://nginx.org/packages/debian/ codename nginx</span></pre> <p><span class="koboSpan" id="kobo.95.1">Here, </span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">codename</span></strong><span class="koboSpan" id="kobo.97.1"> is either </span><strong class="source-inline"><span class="koboSpan" id="kobo.98.1">trixie</span></strong><span class="koboSpan" id="kobo.99.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.100.1">bookworm</span></strong><span class="koboSpan" id="kobo.101.1">, depending on your version of Debian. </span><span class="koboSpan" id="kobo.101.2">For Ubuntu, we use the </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">following dependencies:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.103.1">
deb http://nginx.org/packages/ubuntu/ codename nginx
deb-src http://nginx.org/packages/ubuntu/ codename nginx</span></pre> <p><span class="koboSpan" id="kobo.104.1">Here, </span><strong class="source-inline"><span class="koboSpan" id="kobo.105.1">codename</span></strong><span class="koboSpan" id="kobo.106.1"> is either </span><strong class="source-inline"><span class="koboSpan" id="kobo.107.1">noble</span></strong><span class="koboSpan" id="kobo.108.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">focal</span></strong><span class="koboSpan" id="kobo.110.1">, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.111.1">bionic</span></strong><span class="koboSpan" id="kobo.112.1">, depending on your version of Ubuntu. </span><span class="koboSpan" id="kobo.112.2">Finally, we can install NGINX with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.113.1">apt</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.114.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.115.1">
apt update
apt install </span><a id="_idTextAnchor022"/><span class="koboSpan" id="kobo.116.1">nginx</span></pre> <p><span class="koboSpan" id="kobo.117.1">Now that we have learned how to install NGINX from repositories, let’s have a look at how we can compile it from the source and benefit from having custom modules that are not provided with the </span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">default NGINX.</span></span></p>
<h1 id="_idParaDest-19"><a id="_idTextAnchor023"/><span class="koboSpan" id="kobo.119.1">Compiling NGINX from source</span></h1>
<p><span class="koboSpan" id="kobo.120.1">There are situations</span><a id="_idIndexMarker006"/><span class="koboSpan" id="kobo.121.1"> where compiling NGINX from source is preferable. </span><span class="koboSpan" id="kobo.121.2">It gives us the most flexibility regarding modules, so we can customize better for our intended usage. </span><span class="koboSpan" id="kobo.121.3">For example, we could compile a very lean version for </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">embedded hardware.</span></span></p>
<p><span class="koboSpan" id="kobo.123.1">Additionally, we can make sure we use the latest version of NGINX and have all new features available to us. </span><span class="koboSpan" id="kobo.123.2">Keep in mind, though, that when installing software from source, you are responsible for keeping it updated. </span><span class="koboSpan" id="kobo.123.3">NGINX, just like every other piece of software, sometimes finds security issues that it needs to address. </span><span class="koboSpan" id="kobo.123.4">An OS package is much easier to update than a source installation but, so long as you’re aware of the need to maintain it yourself, there is absolutely </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">no problem.</span></span></p>
<p><span class="koboSpan" id="kobo.125.1">Depending on the optional modules that you select at compile time, you will perhaps need different prerequisites. </span><span class="koboSpan" id="kobo.125.2">We will guide you through the process of installing the most common ones, such as </span><strong class="bold"><span class="koboSpan" id="kobo.126.1">GCC</span></strong><span class="koboSpan" id="kobo.127.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.128.1">PCRE</span></strong><span class="koboSpan" id="kobo.129.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">zlib</span></strong><span class="koboSpan" id="kobo.131.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">and </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.133.1">Op</span><a id="_idTextAnchor024"/><span class="koboSpan" id="kobo.134.1">e</span><a id="_idTextAnchor025"/><span class="koboSpan" id="kobo.135.1">nSSL</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">.</span></span></p>
<h2 id="_idParaDest-20"><a id="_idTextAnchor026"/><span class="koboSpan" id="kobo.137.1">Installing GNU Compiler Collection</span></h2>
<p><span class="koboSpan" id="kobo.138.1">NGINX </span><a id="_idIndexMarker007"/><span class="koboSpan" id="kobo.139.1">is a program written in C, so you will first need to install a compiler tool such as the </span><strong class="bold"><span class="koboSpan" id="kobo.140.1">GNU Compiler Collection</span></strong><span class="koboSpan" id="kobo.141.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.142.1">GCC</span></strong><span class="koboSpan" id="kobo.143.1">) on your </span><a id="_idIndexMarker008"/><span class="koboSpan" id="kobo.144.1">system. </span><span class="koboSpan" id="kobo.144.2">GCC may already be present on </span><a id="_idIndexMarker009"/><span class="koboSpan" id="kobo.145.1">your system, but if that is not the case, you will have to install it before going </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">any further.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.147.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.148.1">GCC is a collection of free open source compilers for various languages – C, C++, Java, Ada, Fortran, and so on. </span><span class="koboSpan" id="kobo.148.2">It is the most commonly used compiler suite in the Linux world, and Windows versions are also available. </span><span class="koboSpan" id="kobo.148.3">A vast number of processors are supported, such as x86, AMD64, PowerPC, ARM, MIPS, </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">and more.</span></span></p>
<p><span class="koboSpan" id="kobo.150.1">Follow these steps to </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">install GCC:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.152.1">First, make sure</span><a id="_idIndexMarker010"/><span class="koboSpan" id="kobo.153.1"> it isn’t already installed on </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">your system:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.155.1">[user@server ~]$ gcc</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.156.1">If you get</span><a id="_idIndexMarker011"/><span class="koboSpan" id="kobo.157.1"> the following output, it means that GCC is correctly installed on your system and you can skip to the </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">next section:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.159.1">gcc: no input files</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.160.1">If you receive the following message, you will have to proceed with the installation of </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">the compiler:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.162.1">~bash: gcc: command not found</span></pre></li> <li><span class="koboSpan" id="kobo.163.1">GCC can be installed using the default repositories of your package manager. </span><span class="koboSpan" id="kobo.163.2">Depending on your distribution, the package manager will be </span><strong class="source-inline"><span class="koboSpan" id="kobo.164.1">vary-yum</span></strong><span class="koboSpan" id="kobo.165.1"> for a Red Hat Linux-based distribution, </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">apt</span></strong><span class="koboSpan" id="kobo.167.1"> for Debian and Ubuntu, </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">yast</span></strong><span class="koboSpan" id="kobo.169.1"> for SUSE Linux, and so on. </span><span class="koboSpan" id="kobo.169.2">Here is the typical way to proceed with the download and installation of the </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">GCC package:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.171.1">[root@server ~]# yum groupinstall "Development Tools"</span></strong></pre></li> <li><span class="koboSpan" id="kobo.172.1">If you use </span><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">apt</span></strong><span class="koboSpan" id="kobo.174.1">, execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.176.1">[root@server ~]# apt-get install build-essentials</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.177.1">If you use another package manager with a different syntax, you will probably find the documentation with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">man</span></strong><span class="koboSpan" id="kobo.179.1"> utility. </span><span class="koboSpan" id="kobo.179.2">Either way, your package manager should be able to download and install GCC correctly, after having resolved </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">dependencies automatically.</span></span></p></li> </ol>
<p><span class="koboSpan" id="kobo.181.1">Note that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">apt</span></strong><span class="koboSpan" id="kobo.183.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">yum</span></strong><span class="koboSpan" id="kobo.185.1"> commands will not only install GCC; they will also proceed to download and install all common requirements for building applications from source, such as code headers and other </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">compil</span><a id="_idTextAnchor027"/><span class="koboSpan" id="kobo.187.1">a</span><a id="_idTextAnchor028"/><span class="koboSpan" id="kobo.188.1">tion tools.</span></span></p>
<h2 id="_idParaDest-21"><a id="_idTextAnchor029"/><span class="koboSpan" id="kobo.189.1">The PCRE library</span></h2>
<p><span class="koboSpan" id="kobo.190.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.191.1">Perl Compatible Regular Expressions</span></strong><span class="koboSpan" id="kobo.192.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.193.1">PCRE</span></strong><span class="koboSpan" id="kobo.194.1">) library is required for compiling NGINX. </span><span class="koboSpan" id="kobo.194.2">The</span><a id="_idIndexMarker012"/><span class="koboSpan" id="kobo.195.1"> rewrite and HTTP core </span><a id="_idIndexMarker013"/><span class="koboSpan" id="kobo.196.1">modules of NGINX use PCRE for the syntax of their regular expressions, as we will discover in later chapters. </span><span class="koboSpan" id="kobo.196.2">You will need to install two packages—</span><strong class="source-inline"><span class="koboSpan" id="kobo.197.1">pcre</span></strong><span class="koboSpan" id="kobo.198.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.199.1">pcre-devel</span></strong><span class="koboSpan" id="kobo.200.1">. </span><span class="koboSpan" id="kobo.200.2">The first one provides the compiled version of the library, whereas the second one provides development headers and sources for compiling projects, which are required in </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">our case.</span></span></p>
<p><span class="koboSpan" id="kobo.202.1">Here are some example commands that you can run in order to install </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">both packages.</span></span></p>
<p><span class="koboSpan" id="kobo.204.1">Using </span><strong class="source-inline"><span class="koboSpan" id="kobo.205.1">yum</span></strong><span class="koboSpan" id="kobo.206.1">, execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.208.1">
[root@server ~]# yum install pcre pcre-devel</span></pre> <p><span class="koboSpan" id="kobo.209.1">Or you can install all PCRE-related packages using the </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.211.1">
[root@server ~]# yum install pcre*</span></pre> <p><span class="koboSpan" id="kobo.212.1">If you use </span><strong class="source-inline"><span class="koboSpan" id="kobo.213.1">apt</span></strong><span class="koboSpan" id="kobo.214.1">, use the </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.216.1">
[root@server ~]# apt install libpcre3 libpcre3-dev</span></pre> <p><span class="koboSpan" id="kobo.217.1">If these packages are already installed on your system, you will receive a message saying something like </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">nothing to do</span></strong><span class="koboSpan" id="kobo.219.1">; in other words, the package manager did not install or update </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">any component:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer010">
<span class="koboSpan" id="kobo.221.1"><img alt="Figure 1.1: APT showing the PCRE library is already installed." src="image/B21787_01_1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.222.1">Figure 1.1: APT showing the PCRE library is already installed.</span></p>
<p><span class="koboSpan" id="kobo.223.1">The preceding output signifies that both the components, </span><strong class="source-inline"><span class="koboSpan" id="kobo.224.1">libpcre3</span></strong><span class="koboSpan" id="kobo.225.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.226.1">libpcre3-dev</span></strong><span class="koboSpan" id="kobo.227.1">, are already present i</span><a id="_idTextAnchor030"/><span class="koboSpan" id="kobo.228.1">n</span><a id="_idTextAnchor031"/> <span class="No-Break"><span class="koboSpan" id="kobo.229.1">the system.</span></span></p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor032"/><span class="koboSpan" id="kobo.230.1">The zlib library</span></h2>
<p><span class="koboSpan" id="kobo.231.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.232.1">zlib</span></strong><span class="koboSpan" id="kobo.233.1"> library </span><a id="_idIndexMarker014"/><span class="koboSpan" id="kobo.234.1">provides developers with compression</span><a id="_idIndexMarker015"/><span class="koboSpan" id="kobo.235.1"> algorithms. </span><span class="koboSpan" id="kobo.235.2">It is required for the use of </span><strong class="source-inline"><span class="koboSpan" id="kobo.236.1">.gzip</span></strong><span class="koboSpan" id="kobo.237.1"> compression in various modules of NGINX. </span><span class="koboSpan" id="kobo.237.2">Again, you can use your package manager to install this component as it is part of the default repositories. </span><span class="koboSpan" id="kobo.237.3">Similar to PCRE, you will need the </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">zlib</span></strong><span class="koboSpan" id="kobo.239.1"> library and its associated </span><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">zlib-dev</span></strong><span class="koboSpan" id="kobo.241.1"> component </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">as well.</span></span></p>
<p><span class="koboSpan" id="kobo.243.1">Using </span><strong class="source-inline"><span class="koboSpan" id="kobo.244.1">yum</span></strong><span class="koboSpan" id="kobo.245.1">, execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.247.1">
[root@server ~]# yum install zlib zlib-devel</span></pre> <p><span class="koboSpan" id="kobo.248.1">Using </span><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">apt</span></strong><span class="koboSpan" id="kobo.250.1">, execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.252.1">
[root@server ~]# apt install zlib1g zlib1g-dev</span></pre> <p><span class="koboSpan" id="kobo.253.1">These packages install quickly and have no known </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">dep</span><a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.255.1">e</span><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.256.1">ndency issues.</span></span></p>
<h2 id="_idParaDest-23"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.257.1">OpenSSL</span></h2>
<p><span class="koboSpan" id="kobo.258.1">The </span><a id="_idIndexMarker016"/><span class="koboSpan" id="kobo.259.1">OpenSSL</span><a id="_idIndexMarker017"/><span class="koboSpan" id="kobo.260.1"> project is a collaborative effort to develop a robust, commercial-grade, full-featured, and open source toolkit implementing</span><a id="_idIndexMarker018"/><span class="koboSpan" id="kobo.261.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.262.1">Secure Sockets Layer</span></strong><span class="koboSpan" id="kobo.263.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.264.1">SSL</span></strong><span class="koboSpan" id="kobo.265.1">) v2/v3 and </span><strong class="bold"><span class="koboSpan" id="kobo.266.1">Transport Layer Security</span></strong><span class="koboSpan" id="kobo.267.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.268.1">TLS</span></strong><span class="koboSpan" id="kobo.269.1">) v1 protocols as well as a full-strength general-purpose cryptography library. </span><span class="koboSpan" id="kobo.269.2">The </span><a id="_idIndexMarker019"/><span class="koboSpan" id="kobo.270.1">project is managed by a worldwide community of volunteers who use the internet to communicate, plan, and</span><a id="_idIndexMarker020"/><span class="koboSpan" id="kobo.271.1"> develop the OpenSSL toolkit and its related documentation. </span><span class="koboSpan" id="kobo.271.2">For more information, </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">visit </span></span><a href="https://www.openssl.org"><span class="No-Break"><span class="koboSpan" id="kobo.273.1">https://www.openssl.org</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.274.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.275.1">The OpenSSL library will be used by NGINX to serve secure web pages. </span><span class="koboSpan" id="kobo.275.2">We thus need to install the library and its development package. </span><span class="koboSpan" id="kobo.275.3">The process remains the same here – you install </span><strong class="source-inline"><span class="koboSpan" id="kobo.276.1">openssl</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.277.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">openssl-devel</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.280.1">
[root@server ~]# yum install openssl openssl-devel</span></pre> <p><span class="koboSpan" id="kobo.281.1">Using </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">apt</span></strong><span class="koboSpan" id="kobo.283.1">, execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.285.1">
[root@server ~]# apt install openssl libssl-dev</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.286.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.287.1">Please be aware of the laws and regulations in your own country. </span><span class="koboSpan" id="kobo.287.2">Some countries do not allow the use of strong cryptography. </span><span class="koboSpan" id="kobo.287.3">The author, publisher, and developers of the OpenSSL and NGINX projects will not be held liable for any violations or law infringements on </span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">your part.</span></span></p>
<p><span class="koboSpan" id="kobo.289.1">Now that you have installed all of the prerequisites, you are ready to download and compile th</span><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.290.1">e</span><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.291.1"> NGINX </span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">source code.</span></span></p>
<h1 id="_idParaDest-24"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.293.1">Downloading and compiling the NGINX source code</span></h1>
<p><span class="koboSpan" id="kobo.294.1">This approach to </span><a id="_idIndexMarker021"/><span class="koboSpan" id="kobo.295.1">the download process will lead us to discover the various resources at the disposal of server administrators, websites, communities, and wikis</span><a id="_idIndexMarker022"/><span class="koboSpan" id="kobo.296.1"> all relating to NGINX. </span><span class="koboSpan" id="kobo.296.2">We will also quickly discuss the different version branches available to you, and eventually, select the most appropria</span><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.297.1">t</span><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.298.1">e one for </span><span class="No-Break"><span class="koboSpan" id="kobo.299.1">your setup.</span></span></p>
<h2 id="_idParaDest-25"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.300.1">Websites and resources</span></h2>
<p><span class="koboSpan" id="kobo.301.1">Although</span><a id="_idIndexMarker023"/><span class="koboSpan" id="kobo.302.1"> NGINX is a relatively new and growing project, there are already a good number of resources available</span><a id="_idIndexMarker024"/><span class="koboSpan" id="kobo.303.1"> on the </span><strong class="bold"><span class="koboSpan" id="kobo.304.1">World Wide Web</span></strong><span class="koboSpan" id="kobo.305.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.306.1">WWW</span></strong><span class="koboSpan" id="kobo.307.1">) and an active community of administrators </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">and developers.</span></span></p>
<p><span class="koboSpan" id="kobo.309.1">The official </span><a id="_idIndexMarker025"/><span class="koboSpan" id="kobo.310.1">website, which is </span><a href="https://nginx.org/"><span class="koboSpan" id="kobo.311.1">https://nginx.org/</span></a><span class="koboSpan" id="kobo.312.1">, currently serves as an official documentation reference and provides links from which to download the latest version of the application source code and binaries. </span><span class="koboSpan" id="kobo.312.2">A wiki is also available at </span><a href="https://www.nginx.com/resources/wiki/"><span class="koboSpan" id="kobo.313.1">https://www.nginx.com/resources/wiki/</span></a><span class="koboSpan" id="kobo.314.1"> and offers a wide selection of additional resources such as installation guides for various operating systems, tutorials related to the different modules of NGINX, </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">and more.</span></span></p>
<p><span class="koboSpan" id="kobo.316.1">There are several ways to get help if you should need it. </span><span class="koboSpan" id="kobo.316.2">If you have a specific question, try posting on the NGINX forum at </span><a href="https://forum.nginx.org/"><span class="koboSpan" id="kobo.317.1">https://forum.nginx.org/</span></a><span class="koboSpan" id="kobo.318.1">. </span><span class="koboSpan" id="kobo.318.2">An active community of users will answer your questions in no time. </span><span class="koboSpan" id="kobo.318.3">Additionally, the NGINX mailing list, which is relayed on the NGINX forum, will also prove to be an excellent resource for any question you may have. </span><span class="koboSpan" id="kobo.318.4">If you need direct assistance, there is always a group of regulars helping each other out on the IRC channel, </span><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">#Nginx</span></strong><span class="koboSpan" id="kobo.320.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">on </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">irc.libera.chat</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.323.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.324.1">Another interesting source of information is the blogosphere. </span><span class="koboSpan" id="kobo.324.2">A simple query on your favorite search engine</span><a id="_idIndexMarker026"/><span class="koboSpan" id="kobo.325.1"> should return a good number of blog articles documenting NGINX, its configuration, </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">and modules:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer011">
<span class="koboSpan" id="kobo.327.1"><img alt="Figure 1.2: Websites and blogs documenting Nginx" src="image/B21787_01_2.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.328.1">Figure 1.2: Websites and blogs documenting Nginx</span></p>
<p><span class="koboSpan" id="kobo.329.1">It’s now time to </span><a id="_idIndexMarker027"/><span class="koboSpan" id="kobo.330.1">head over to the official website and get started with downloading the source code for compiling and installing NGINX. </span><span class="koboSpan" id="kobo.330.2">Before you do so, let us have a quick summary of the available versions and the fea</span><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.331.1">t</span><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.332.1">ures that come </span><span class="No-Break"><span class="koboSpan" id="kobo.333.1">with them.</span></span></p>
<h2 id="_idParaDest-26"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.334.1">Version branches</span></h2>
<p><span class="koboSpan" id="kobo.335.1">Igor Sysoev, a</span><a id="_idIndexMarker028"/><span class="koboSpan" id="kobo.336.1"> talented Russian developer and </span><a id="_idIndexMarker029"/><span class="koboSpan" id="kobo.337.1">server administrator, initiated this open source project back in 2002. </span><span class="koboSpan" id="kobo.337.2">Between the first release in 2004 and the current version, the market share of NGINX has been growing steadily. </span><span class="koboSpan" id="kobo.337.3">It now serves nearly 26.23% of websites on the internet, according to an April 2023 survey on </span><a href="https://www.netcraft.com/"><span class="koboSpan" id="kobo.338.1">https://www.netcraft.com/</span></a><span class="koboSpan" id="kobo.339.1">. </span><span class="koboSpan" id="kobo.339.2">The features are numerous and render the application both powerful and flexible at the </span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">same time.</span></span></p>
<p><span class="koboSpan" id="kobo.341.1">There are currently three version branches of </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">the project:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.343.1">Stable version</span></strong><span class="koboSpan" id="kobo.344.1">: This</span><a id="_idIndexMarker030"/><span class="koboSpan" id="kobo.345.1"> version is usually recommended, as it is approved by both developers and users, but is usually a little behind the </span><span class="No-Break"><span class="koboSpan" id="kobo.346.1">mainline version.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.347.1">Mainline version</span></strong><span class="koboSpan" id="kobo.348.1">: This is the</span><a id="_idIndexMarker031"/><span class="koboSpan" id="kobo.349.1"> latest version available for download and comes with the newest developments and bug fixes. </span><span class="koboSpan" id="kobo.349.2">It was formerly known</span><a id="_idIndexMarker032"/><span class="koboSpan" id="kobo.350.1"> as the </span><strong class="bold"><span class="koboSpan" id="kobo.351.1">development version</span></strong><span class="koboSpan" id="kobo.352.1">. </span><span class="koboSpan" id="kobo.352.2">Although it is generally solid enough to be installed on production servers, there is a small chance that you will run into the occasional bug. </span><span class="koboSpan" id="kobo.352.3">As such, if you favor stability over novelty, going for the stable version </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">is recommended.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.354.1">Legacy version</span></strong><span class="koboSpan" id="kobo.355.1">: If, for </span><a id="_idIndexMarker033"/><span class="koboSpan" id="kobo.356.1">some reason, you are interested in looking at the older versions, you will find several </span><span class="No-Break"><span class="koboSpan" id="kobo.357.1">of them.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.358.1">A recurrent </span><a id="_idIndexMarker034"/><span class="koboSpan" id="kobo.359.1">question regarding mainline versions is “</span><em class="italic"><span class="koboSpan" id="kobo.360.1">Are they stable enough to be used on production servers?</span></em><span class="koboSpan" id="kobo.361.1">” Cliff Wells, the original founder and maintainer of the NGINX wiki at </span><a href="https://www.nginx.com/resources/wiki/"><span class="koboSpan" id="kobo.362.1">https://www.nginx.com/resources/wiki/</span></a><span class="koboSpan" id="kobo.363.1">, believes so – “</span><em class="italic"><span class="koboSpan" id="kobo.364.1">I generally use and recommend the latest development version. </span><span class="koboSpan" id="kobo.364.2">It’s only bit me once!</span></em><span class="koboSpan" id="kobo.365.1">” Early adopters rarely report critical problems. </span><span class="koboSpan" id="kobo.365.2">It is up to you to select the version you will be using on your server, knowing that the instructions given in this book should be valid regardless of the release as the NGINX developers have decided to maintain overall backward compatibility in new versions. </span><span class="koboSpan" id="kobo.365.3">You can find more information on version changes, new additions, and bug fixes on the dedicated change </span><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.366.1">l</span><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.367.1">og page on the </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">official website.</span></span></p>
<h2 id="_idParaDest-27"><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.369.1">Features</span></h2>
<p><span class="koboSpan" id="kobo.370.1">As of the </span><a id="_idIndexMarker035"/><span class="koboSpan" id="kobo.371.1">mainline version 1.25.2, NGINX offers an impressive variety of features, which, contrary to what the title of this book indicates, are not all related to serving HTTP content. </span><span class="koboSpan" id="kobo.371.2">Here is a list of the main features of the web branch, quoted from the official </span><span class="No-Break"><span class="koboSpan" id="kobo.372.1">website (</span></span><a href="https://nginx.org/"><span class="No-Break"><span class="koboSpan" id="kobo.373.1">https://nginx.org/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.374.1">):</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.375.1">Serving static and index files, auto indexing; open file descriptor cache; accelerated reverse proxying with caching; load balancing and </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">fault tolerance.</span></span></li>
<li><span class="koboSpan" id="kobo.377.1">Accelerated support with caching of FastCGI, uWSGI, SCGI, and memcached servers; load balancing and fault tolerance; modular architecture. </span><span class="koboSpan" id="kobo.377.2">Filters include gzipping, byte ranges, chunked responses, XSLT, SSI, and image transformation filter. </span><span class="koboSpan" id="kobo.377.3">Multiple SSI inclusions within a single page can be processed in parallel if they are handled by proxies or </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">FastCGI/uWSGI/SCGI servers.</span></span></li>
<li><span class="koboSpan" id="kobo.379.1">SSL and TLS </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">SNI support.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.381.1">NGINX can also be</span><a id="_idIndexMarker036"/><span class="koboSpan" id="kobo.382.1"> used as a mail proxy server. </span><span class="koboSpan" id="kobo.382.2">Although this aspect will not be closely documented in the book, the following will provide you with some insight </span><span class="No-Break"><span class="koboSpan" id="kobo.383.1">into it:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.384.1">User redirection to IMAP/POP3 backend using an external HTTP </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">authentication server</span></span></li>
<li><span class="koboSpan" id="kobo.386.1">User authentication using an external HTTP authentication server and connection redirection to an internal </span><span class="No-Break"><span class="koboSpan" id="kobo.387.1">SMTP backend</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.388.1">Authentication methods:</span></span><ul><li><strong class="bold"><span class="koboSpan" id="kobo.389.1">POP3</span></strong><span class="koboSpan" id="kobo.390.1">: </span><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">USER/PASS, APOP, </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">AUTH LOGIN/PLAIN/CRAM-MD5</span></strong></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.393.1">IMAP</span></strong><span class="koboSpan" id="kobo.394.1">: </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">LOGIN, </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.396.1">AUTH LOGIN/PLAIN/CRAM-MD5</span></strong></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.397.1">SMTP</span></strong><span class="koboSpan" id="kobo.398.1">: </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.399.1">AUTH LOGIN/PLAIN/CRAM-MD5</span></strong></span></li><li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.400.1">SSL support</span></strong></span></li><li><strong class="bold"><span class="koboSpan" id="kobo.401.1">STARTTLS and </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.402.1">STLS support</span></strong></span></li></ul></li>
</ul>
<p><span class="koboSpan" id="kobo.403.1">NGINX is compatible with most computer architectures and operating systems—Windows, Linux, macOS, FreeBSD, and Solaris. </span><span class="koboSpan" id="kobo.403.2">The application runs fi</span><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.404.1">n</span><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.405.1">e on 32- and </span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">64-bit architectures.</span></span></p>
<h2 id="_idParaDest-28"><a id="_idTextAnchor050"/><span class="koboSpan" id="kobo.407.1">Downloading and extracting</span></h2>
<p><span class="koboSpan" id="kobo.408.1">Once you have made</span><a id="_idIndexMarker037"/><span class="koboSpan" id="kobo.409.1"> your choice as to which version you will be using, head over to </span><a href="https://nginx.org/"><span class="koboSpan" id="kobo.410.1">https://nginx.org/</span></a><span class="koboSpan" id="kobo.411.1"> and find the URL </span><a id="_idIndexMarker038"/><span class="koboSpan" id="kobo.412.1">of the file you wish to download. </span><span class="koboSpan" id="kobo.412.2">Position yourself in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.413.1">home</span></strong><span class="koboSpan" id="kobo.414.1"> directory, which will contain the source code to be compiled, and download the file </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.416.1">wget</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.418.1">
[user@server ~]$ mkdir src &amp;&amp; cd src
[user@server src]$ wget https://nginx.org/download/nginx-1.25.2.tar.gz</span></pre> <p><span class="koboSpan" id="kobo.419.1">We will be</span><a id="_idIndexMarker039"/><span class="koboSpan" id="kobo.420.1"> using version </span><strong class="source-inline"><span class="koboSpan" id="kobo.421.1">1.25.2</span></strong><span class="koboSpan" id="kobo.422.1">, the latest stable version as of September 2023. </span><span class="koboSpan" id="kobo.422.2">Once downloaded, extract the archive contents in the </span><span class="No-Break"><span class="koboSpan" id="kobo.423.1">current folder:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.424.1">
[user@server src]$ tar zxf nginx-1.25.2.tar.gz</span></pre> <p><span class="koboSpan" id="kobo.425.1">You have successfully downloaded and extracted NGINX. </span><span class="koboSpan" id="kobo.425.2">Now, the next step will be to configure the compilation process in order to obtain a binary that</span><a id="_idTextAnchor051"/> <a id="_idTextAnchor052"/><span class="koboSpan" id="kobo.426.1">perfectly fits your </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">operating system.</span></span></p>
<h1 id="_idParaDest-29"><a id="_idTextAnchor053"/><span class="koboSpan" id="kobo.428.1">Exploring the options for configuring the compilation</span></h1>
<p><span class="koboSpan" id="kobo.429.1">There are usually three steps when building an application from source—</span><em class="italic"><span class="koboSpan" id="kobo.430.1">configuration</span></em><span class="koboSpan" id="kobo.431.1">, </span><em class="italic"><span class="koboSpan" id="kobo.432.1">compilation</span></em><span class="koboSpan" id="kobo.433.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.434.1">installation</span></em><span class="koboSpan" id="kobo.435.1">. </span><span class="koboSpan" id="kobo.435.2">The configuration step allows you to select a number of options that will not be editable after the program is built, as it has a direct impact on the project binaries. </span><span class="koboSpan" id="kobo.435.3">Consequently, it is a very important stage that you need to follow carefully if you want to avoid surprises later, such as the lack of a specific module or files being located in a </span><span class="No-Break"><span class="koboSpan" id="kobo.436.1">random folder.</span></span></p>
<p><span class="koboSpan" id="kobo.437.1">The process consists of appending certain switches to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">configure</span></strong><span class="koboSpan" id="kobo.439.1"> script that comes with the source code. </span><span class="koboSpan" id="kobo.439.2">We will discover the three types of switches that you can activate, but let us f</span><a id="_idTextAnchor054"/><span class="koboSpan" id="kobo.440.1">i</span><a id="_idTextAnchor055"/><span class="koboSpan" id="kobo.441.1">rst study the easiest way </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">to proceed.</span></span></p>
<h2 id="_idParaDest-30"><a id="_idTextAnchor056"/><span class="koboSpan" id="kobo.443.1">The easy way</span></h2>
<p><span class="koboSpan" id="kobo.444.1">If, for some </span><a id="_idIndexMarker040"/><span class="koboSpan" id="kobo.445.1">reason, you do not want to bother with the configuration step, such as for testing purposes or simply because you will be recompiling the application in the future, you may simply use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.446.1">configure</span></strong><span class="koboSpan" id="kobo.447.1"> command with no switches. </span><span class="koboSpan" id="kobo.447.2">Execute the following three commands to build and install a working version </span><span class="No-Break"><span class="koboSpan" id="kobo.448.1">of NGINX:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.449.1">
[user@server nginx-1.25.2]# ./configure</span></pre> <p><span class="koboSpan" id="kobo.450.1">Running this command should initiate a long procedure of verifications to ensure that your system contains all of the necessary components. </span><span class="koboSpan" id="kobo.450.2">If the configuration process fails, please make sure you check the prerequisites section again, as it is the most common cause of errors. </span><span class="koboSpan" id="kobo.450.3">For information about why the command failed, you may also refer to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">objs/autoconf.err</span></strong><span class="koboSpan" id="kobo.452.1"> file, which provides a more detailed report. </span><span class="koboSpan" id="kobo.452.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.453.1">make</span></strong><span class="koboSpan" id="kobo.454.1"> command will compile </span><span class="No-Break"><span class="koboSpan" id="kobo.455.1">the application:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.456.1">
[user@server nginx-1.25.2]# make</span></pre> <p><span class="koboSpan" id="kobo.457.1">This step should not cause any errors as long as the configuration </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">went fine:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.459.1">
[root@server nginx-1.25.2]# make install</span></pre> <p><span class="koboSpan" id="kobo.460.1">This last step </span><a id="_idIndexMarker041"/><span class="koboSpan" id="kobo.461.1">will copy the compiled files as well as other resources to the installation directory, by default </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">/usr/local/nginx</span></strong><span class="koboSpan" id="kobo.463.1">. </span><span class="koboSpan" id="kobo.463.2">You may need to be logged in as </span><strong class="source-inline"><span class="koboSpan" id="kobo.464.1">root</span></strong><span class="koboSpan" id="kobo.465.1"> to perform this operation depending on permissions granted to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.466.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">usr/local</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.468.1"> directory.</span></span></p>
<p><span class="koboSpan" id="kobo.469.1">Again, if you build the application without configuring it, you take the risk of missing out on a lot of features, such as the optional modules a</span><a id="_idTextAnchor057"/><span class="koboSpan" id="kobo.470.1">n</span><a id="_idTextAnchor058"/><span class="koboSpan" id="kobo.471.1">d others that we are about </span><span class="No-Break"><span class="koboSpan" id="kobo.472.1">to discover.</span></span></p>
<h2 id="_idParaDest-31"><a id="_idTextAnchor059"/><span class="koboSpan" id="kobo.473.1">Path options</span></h2>
<p><span class="koboSpan" id="kobo.474.1">When</span><a id="_idIndexMarker042"/><span class="koboSpan" id="kobo.475.1"> running the </span><strong class="source-inline"><span class="koboSpan" id="kobo.476.1">configure</span></strong><span class="koboSpan" id="kobo.477.1"> command, you are offered the chance to enable some switches that let you specify the directory or file paths for a variety of elements. </span><span class="koboSpan" id="kobo.477.2">Please note that the options offered by the configuration switches may change according to the version you downloaded. </span><span class="koboSpan" id="kobo.477.3">The following options listed are valid with the stable version, as of release 1.25.2. </span><span class="koboSpan" id="kobo.477.4">If you use another version, run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">./configure --help</span></strong><span class="koboSpan" id="kobo.479.1"> command to list the available switches for </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">your setup.</span></span></p>
<p><span class="koboSpan" id="kobo.481.1">Using a switch typically consists of appending some text to the command line. </span><span class="koboSpan" id="kobo.481.2">Here is an example using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">--</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">conf-path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.484.1"> switch:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.485.1">
[root@server nginx]# ./configure --conf-path=/etc/nginx/nginx.conf</span></pre> <p><span class="koboSpan" id="kobo.486.1">Most of the time, the default configuration switches do not need customization. </span><span class="koboSpan" id="kobo.486.2">However, it is highly recommended to have a look at the configuration switches in the official documentation page, </span><strong class="bold"><span class="koboSpan" id="kobo.487.1">Building NGINX from Sources</span></strong><span class="koboSpan" id="kobo.488.1">, in order to configure the right paths for your logs, modules such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">https</span></strong><span class="koboSpan" id="kobo.490.1">, and libraries such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">geoip</span></strong><span class="koboSpan" id="kobo.492.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">gzip</span></strong><span class="koboSpan" id="kobo.494.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">zlib</span></strong><span class="koboSpan" id="kobo.496.1">, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">pcre</span></strong><span class="koboSpan" id="kobo.498.1">. </span><span class="koboSpan" id="kobo.498.2">Do note that, in this book, we will compile NGINX with the standard switches from </span><strong class="bold"><span class="koboSpan" id="kobo.499.1">Building NGINX from Sources</span></strong><span class="koboSpan" id="kobo.500.1"> and we will be aligned with the compiled binaries</span><a id="_idTextAnchor060"/><a id="_idIndexMarker043"/><a id="_idTextAnchor061"/><a id="_idTextAnchor062"/><a id="_idTextAnchor063"/><a id="_idTextAnchor064"/><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.501.1"> used by the popular </span><span class="No-Break"><span class="koboSpan" id="kobo.502.1">Linux distributions.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.503.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.504.1">Be aware that these configurations do not include additional third-party modules. </span><span class="koboSpan" id="kobo.504.2">Please refer to </span><a href="B21787_05.xhtml#_idTextAnchor557"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.505.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.506.1">, for </span><a id="_idTextAnchor066"/><a id="_idTextAnchor067"/><a id="_idTextAnchor068"/><a id="_idTextAnchor069"/><a id="_idTextAnchor070"/><span class="koboSpan" id="kobo.507.1">m</span><a id="_idTextAnchor071"/><span class="koboSpan" id="kobo.508.1">ore information about </span><span class="No-Break"><span class="koboSpan" id="kobo.509.1">installing add-ons.</span></span></p>
<h2 id="_idParaDest-32"><a id="_idTextAnchor072"/><span class="koboSpan" id="kobo.510.1">Build configuration issues</span></h2>
<p><span class="koboSpan" id="kobo.511.1">In some</span><a id="_idIndexMarker044"/><span class="koboSpan" id="kobo.512.1"> cases, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.513.1">configure</span></strong><span class="koboSpan" id="kobo.514.1"> command may fail – after a long list of checks, you may receive a few error messages on your terminal. </span><span class="koboSpan" id="kobo.514.2">In most (if not all) cases, these errors are related to missing prerequisites or </span><span class="No-Break"><span class="koboSpan" id="kobo.515.1">unspecified paths.</span></span></p>
<p><span class="koboSpan" id="kobo.516.1">In such cases, proceed with the following verifications carefully to make sure you have all it takes to compile the application, and optionally consult the </span><strong class="source-inline"><span class="koboSpan" id="kobo.517.1">objs/autoconf.err</span></strong><span class="koboSpan" id="kobo.518.1"> file for more details about the compilation problem. </span><span class="koboSpan" id="kobo.518.2">This file is generated during the </span><strong class="source-inline"><span class="koboSpan" id="kobo.519.1">configure</span></strong><span class="koboSpan" id="kobo.520.1"> process and will tell yo</span><a id="_idTextAnchor073"/><span class="koboSpan" id="kobo.521.1">u</span><a id="_idTextAnchor074"/><span class="koboSpan" id="kobo.522.1"> exactly which part of the </span><span class="No-Break"><span class="koboSpan" id="kobo.523.1">process failed.</span></span></p>
<h3><span class="koboSpan" id="kobo.524.1">Make sure you installed the prerequisites</span></h3>
<p><span class="koboSpan" id="kobo.525.1">There are</span><a id="_idIndexMarker045"/><span class="koboSpan" id="kobo.526.1"> basically four main prerequisites: GCC, PCRE, </span><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">zlib</span></strong><span class="koboSpan" id="kobo.528.1">, and OpenSSL. </span><span class="koboSpan" id="kobo.528.2">The last three are libraries that must be installed in two packages: the library itself and its development sources. </span><span class="koboSpan" id="kobo.528.3">Make sure you have installed both for each of them. </span><span class="koboSpan" id="kobo.528.4">Please refer to the prerequisites at the beginning of this chapter. </span><span class="koboSpan" id="kobo.528.5">Note that other prerequisites, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.529.1">LibXML2</span></strong><span class="koboSpan" id="kobo.530.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">LibXSLT</span></strong><span class="koboSpan" id="kobo.532.1">, might be required to enable extra modules (for example, in the case of the HTTP </span><span class="No-Break"><span class="koboSpan" id="kobo.533.1">XSLT module).</span></span></p>
<p><span class="koboSpan" id="kobo.534.1">If you are positive that all of the prerequisites were installed correctly, perhaps the issue comes from the fact that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">configure</span></strong><span class="koboSpan" id="kobo.536.1"> script is unable to locate the prerequisite files. </span><span class="koboSpan" id="kobo.536.2">In that case, make sure that you include the configuration switches related to file paths, as </span><span class="No-Break"><span class="koboSpan" id="kobo.537.1">described earlier.</span></span></p>
<p><span class="koboSpan" id="kobo.538.1">For example, the following switch allows you to specify the location of the OpenSSL </span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">library files:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.540.1">
./configure [...] --with-openssl=/usr/lib64</span></pre> <p><span class="koboSpan" id="kobo.541.1">The OpenSSL library </span><a id="_idIndexMarker046"/><span class="koboSpan" id="kobo.542.1">fil</span><a id="_idTextAnchor075"/><span class="koboSpan" id="kobo.543.1">e</span><a id="_idTextAnchor076"/><span class="koboSpan" id="kobo.544.1"> will be looked for in the </span><span class="No-Break"><span class="koboSpan" id="kobo.545.1">specified folder.</span></span></p>
<h3><span class="koboSpan" id="kobo.546.1">Directories exist and are writable</span></h3>
<p><span class="koboSpan" id="kobo.547.1">Always </span><a id="_idIndexMarker047"/><span class="koboSpan" id="kobo.548.1">remember to check the obvious; everyone makes even the simplest of mistakes sooner or later. </span><span class="koboSpan" id="kobo.548.2">Make sure the directory you placed the NGINX files in has </span><em class="italic"><span class="koboSpan" id="kobo.549.1">read</span></em><span class="koboSpan" id="kobo.550.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.551.1">write</span></em><span class="koboSpan" id="kobo.552.1"> permissions for the user running the configuration and compilation scripts. </span><span class="koboSpan" id="kobo.552.2">Also ensure that all paths specified in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">config</span><a id="_idTextAnchor077"/><span class="koboSpan" id="kobo.554.1">u</span><a id="_idTextAnchor078"/><span class="koboSpan" id="kobo.555.1">re</span></strong><span class="koboSpan" id="kobo.556.1"> script switches are existing, </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">valid paths.</span></span></p>
<h2 id="_idParaDest-33"><a id="_idTextAnchor079"/><span class="koboSpan" id="kobo.558.1">Compiling and installing</span></h2>
<p><span class="koboSpan" id="kobo.559.1">The configuration </span><a id="_idIndexMarker048"/><span class="koboSpan" id="kobo.560.1">process is of the utmost importance—it generates a makefile for the application depending on the selected switches and performs a long list of requirement checks on your system. </span><span class="koboSpan" id="kobo.560.2">Once the </span><strong class="source-inline"><span class="koboSpan" id="kobo.561.1">configure</span></strong><span class="koboSpan" id="kobo.562.1"> script is successfully executed, you can proceed with </span><span class="No-Break"><span class="koboSpan" id="kobo.563.1">compiling NGINX.</span></span></p>
<p><span class="koboSpan" id="kobo.564.1">Compiling the project equates to executing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">make</span></strong><span class="koboSpan" id="kobo.566.1"> command in the project </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">source directory:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.568.1">
[user@server nginx-1.25.2]$ make</span></pre> <p><span class="koboSpan" id="kobo.569.1">A successful build should result in a final message appearing: </span><strong class="source-inline"><span class="koboSpan" id="kobo.570.1">make[1]: leaving directory</span></strong><span class="koboSpan" id="kobo.571.1"> followed by the project </span><span class="No-Break"><span class="koboSpan" id="kobo.572.1">source path.</span></span></p>
<p><span class="koboSpan" id="kobo.573.1">Again, problems might occur at compile time. </span><span class="koboSpan" id="kobo.573.2">Most of these problems can originate from missing prerequisites or invalid paths specified. </span><span class="koboSpan" id="kobo.573.3">If this occurs, run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.574.1">configure</span></strong><span class="koboSpan" id="kobo.575.1"> command again and triple-check the switches and all of the prerequisite options. </span><span class="koboSpan" id="kobo.575.2">It may also be that you downloaded a too-recent version of the prerequisites that might not be backward-compatible. </span><span class="koboSpan" id="kobo.575.3">In such cases, the best option is to visit the official website of the missing component and download an </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">older version.</span></span></p>
<p><span class="koboSpan" id="kobo.577.1">If the compilation process was successful, you are ready for the next step: installing the application. </span><span class="koboSpan" id="kobo.577.2">The following command must be executed with </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">root</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.579.1"> privileges:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.580.1">
[root@server nginx-1.25.2]# make install</span></pre> <p><span class="koboSpan" id="kobo.581.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">make install</span></strong><span class="koboSpan" id="kobo.583.1"> command executes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">install</span></strong><span class="koboSpan" id="kobo.585.1"> section of the makefile. </span><span class="koboSpan" id="kobo.585.2">In other words, it performs a few simple operations, such as copying binaries and configuration files to the specified </span><strong class="source-inline"><span class="koboSpan" id="kobo.586.1">install</span></strong><span class="koboSpan" id="kobo.587.1"> folder. </span><span class="koboSpan" id="kobo.587.2">It also creates directories for storing log and HTML files, if these do not already exist. </span><span class="koboSpan" id="kobo.587.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.588.1">make install</span></strong><span class="koboSpan" id="kobo.589.1"> step is not generally a source of problems unless your system encounters an exceptional error, such as a lack of storage space </span><span class="No-Break"><span class="koboSpan" id="kobo.590.1">or memory.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.591.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.592.1">You might require </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">root</span></strong><span class="koboSpan" id="kobo.594.1"> privileges for installing the application in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.595.1">/usr/local/</span></strong><span class="koboSpan" id="kobo.596.1"> folder, depending on the </span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">folder permissions.</span></span></p>
<p><span class="koboSpan" id="kobo.598.1">NGINX is now</span><a id="_idIndexMarker049"/><span class="koboSpan" id="kobo.599.1"> ready as it has been compiled successfully. </span><span class="koboSpan" id="kobo.599.2">In the next section, we will turn</span><a id="_idTextAnchor080"/> <a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.600.1">NGINX into a daemon running in </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">the background.</span></span></p>
<h1 id="_idParaDest-34"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.602.1">Controlling the NGINX service</span></h1>
<p><span class="koboSpan" id="kobo.603.1">At this </span><a id="_idIndexMarker050"/><span class="koboSpan" id="kobo.604.1">stage, you should have successfully built and installed NGINX. </span><span class="koboSpan" id="kobo.604.2">The default location for the output files is </span><strong class="source-inline"><span class="koboSpan" id="kobo.605.1">/usr/local/nginx</span></strong><span class="koboSpan" id="kobo.606.1">, so we will be basing future examples using this path to start, stop, run at boot, an</span><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.607.1">d</span><a id="_idTextAnchor084"/><span class="koboSpan" id="kobo.608.1"> keep an eye on the NGINX status using </span><span class="No-Break"><span class="koboSpan" id="kobo.609.1">a daemon.</span></span></p>
<h2 id="_idParaDest-35"><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.610.1">Daemons and services</span></h2>
<p><span class="koboSpan" id="kobo.611.1">The next</span><a id="_idIndexMarker051"/><span class="koboSpan" id="kobo.612.1"> step is obviously to execute NGINX. </span><span class="koboSpan" id="kobo.612.2">However, before doing so, it’s important to understand the nature of this application. </span><span class="koboSpan" id="kobo.612.3">There are two types of computer applications—those that require immediate user input, thus running in the foreground, and those that do not, thus running in the background. </span><span class="koboSpan" id="kobo.612.4">NGINX is of the latter type, often referred to as daemon. </span><span class="koboSpan" id="kobo.612.5">Daemon names usually come with a trailing </span><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">d</span></strong><span class="koboSpan" id="kobo.614.1"> and a couple of examples can be mentioned here—</span><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">httpd</span></strong><span class="koboSpan" id="kobo.616.1"> (the HTTP server daemon) is the name given to Apache under several Linux distributions, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">named</span></strong><span class="koboSpan" id="kobo.618.1"> is the name server daemon. </span><strong class="source-inline"><span class="koboSpan" id="kobo.619.1">cron</span></strong><span class="koboSpan" id="kobo.620.1"> is the task scheduler—although, as you will notice, it is not the case for NGINX. </span><span class="koboSpan" id="kobo.620.2">When started from the command line, a daemon immediately returns the prompt window, and in most cases, does not even bother outputting data to </span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">the terminal.</span></span></p>
<p><span class="koboSpan" id="kobo.622.1">Consequently, when </span><a id="_idIndexMarker052"/><span class="koboSpan" id="kobo.623.1">starting NGINX, you will not see any text appear on the screen and the prompt will return immediately. </span><span class="koboSpan" id="kobo.623.2">While this might seem startling, it is, on the contrary, a good sign. </span><span class="koboSpan" id="kobo.623.3">It means the daemon was started correctl</span><a id="_idTextAnchor086"/><span class="koboSpan" id="kobo.624.1">y</span><a id="_idTextAnchor087"/><span class="koboSpan" id="kobo.625.1"> and the configuration did not contain </span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">any errors.</span></span></p>
<h2 id="_idParaDest-36"><a id="_idTextAnchor088"/><span class="koboSpan" id="kobo.627.1">Users and groups</span></h2>
<p><span class="koboSpan" id="kobo.628.1">It is of the </span><a id="_idIndexMarker053"/><span class="koboSpan" id="kobo.629.1">utmost importance to understand the process architecture of NGINX, particularly the users and groups its various processes run under. </span><span class="koboSpan" id="kobo.629.2">A very common source of trouble when setting up NGINX is invalid file access permissions—due to a user or group misconfiguration, you often end up getting </span><strong class="source-inline"><span class="koboSpan" id="kobo.630.1">403 Forbidden</span></strong><span class="koboSpan" id="kobo.631.1"> HTTP errors because NGINX cannot access the </span><span class="No-Break"><span class="koboSpan" id="kobo.632.1">requested files.</span></span></p>
<p><span class="koboSpan" id="kobo.633.1">There are two levels of processes with possibly different </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">permission sets:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.635.1">NGINX master process</span></strong><span class="koboSpan" id="kobo.636.1">: This </span><a id="_idIndexMarker054"/><span class="koboSpan" id="kobo.637.1">should be started as </span><strong class="source-inline"><span class="koboSpan" id="kobo.638.1">root</span></strong><span class="koboSpan" id="kobo.639.1">. </span><span class="koboSpan" id="kobo.639.2">In most Unix-like systems, processes started with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">root</span></strong><span class="koboSpan" id="kobo.641.1"> account are allowed to open TCP sockets on any port, whereas other users can only open listening sockets on a port above </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">1024</span></strong><span class="koboSpan" id="kobo.643.1">. </span><span class="koboSpan" id="kobo.643.2">If you do not start NGINX as </span><strong class="source-inline"><span class="koboSpan" id="kobo.644.1">root</span></strong><span class="koboSpan" id="kobo.645.1">, standard ports such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.646.1">80</span></strong><span class="koboSpan" id="kobo.647.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">443</span></strong><span class="koboSpan" id="kobo.649.1"> will not </span><span class="No-Break"><span class="koboSpan" id="kobo.650.1">be accessible.</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.651.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.652.1">The user directive that allows you to specify a different user and group for the worker processes will not be taken into consideration for the </span><span class="No-Break"><span class="koboSpan" id="kobo.653.1">master process.</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.654.1">NGINX worker processes</span></strong><span class="koboSpan" id="kobo.655.1">: These </span><a id="_idIndexMarker055"/><span class="koboSpan" id="kobo.656.1">are automatically spawned by the master process under the account you specified in the configuration file with the user directive (detailed in </span><a href="B21787_02.xhtml#_idTextAnchor121"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.657.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.658.1">, </span><em class="italic"><span class="koboSpan" id="kobo.659.1">Basic Nginx Configuration</span></em><span class="koboSpan" id="kobo.660.1">). </span><span class="koboSpan" id="kobo.660.2">The configuration setting takes precedence over the configuration switch you may have specified at compile time. </span><span class="koboSpan" id="kobo.660.3">If you did not specify any of those, the worker processes will be started as </span><strong class="source-inline"><span class="koboSpan" id="kobo.661.1">user nobody</span></strong><span class="koboSpan" id="kobo.662.1">, and the gro</span><a id="_idTextAnchor089"/><span class="koboSpan" id="kobo.663.1">u</span><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.664.1">p will be nobody (or </span><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">nogroup</span></strong><span class="koboSpan" id="kobo.666.1">, depending on </span><span class="No-Break"><span class="koboSpan" id="kobo.667.1">your OS).</span></span></li>
</ul>
<h2 id="_idParaDest-37"><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.668.1">NGINX command-line switches</span></h2>
<p><span class="koboSpan" id="kobo.669.1">The </span><a id="_idIndexMarker056"/><span class="koboSpan" id="kobo.670.1">NGINX binary accepts command-line arguments for performing various operations, among which is controlling background processes. </span><span class="koboSpan" id="kobo.670.2">To get a full list of commands, you may invoke the </span><strong class="bold"><span class="koboSpan" id="kobo.671.1">Help</span></strong><span class="koboSpan" id="kobo.672.1"> screen using the </span><span class="No-Break"><span class="koboSpan" id="kobo.673.1">following commands:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.674.1">
[user@server ~]$ cd /usr/local/nginx/sbin
[user@server sbin]$ ./nginx -h</span></pre> <p><span class="koboSpan" id="kobo.675.1">The next few sections will describe the purpose of these switches. </span><span class="koboSpan" id="kobo.675.2">Some allow you to control the daemon, and some let you perfor</span><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.676.1">m</span><a id="_idTextAnchor093"/><span class="koboSpan" id="kobo.677.1"> various operations on the </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">application configuration.</span></span></p>
<h2 id="_idParaDest-38"><a id="_idTextAnchor094"/><span class="koboSpan" id="kobo.679.1">Starting and stopping the daemon</span></h2>
<p><span class="koboSpan" id="kobo.680.1">You can start </span><a id="_idIndexMarker057"/><span class="koboSpan" id="kobo.681.1">NGINX by running the NGINX binary without any </span><a id="_idIndexMarker058"/><span class="koboSpan" id="kobo.682.1">switches. </span><span class="koboSpan" id="kobo.682.2">If the daemon is already running, a message will show up indicating that a socket is already listening on the </span><span class="No-Break"><span class="koboSpan" id="kobo.683.1">specified port:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.684.1">
[emerg]: bind() to 0.0.0.0:80 failed (98: Address already in use) [...] [emerg]: still could not bind().</span></pre> <p><span class="koboSpan" id="kobo.685.1">Beyond this point, you may control the daemon by stopping it, restarting it, or simply reloading its configuration. </span><span class="koboSpan" id="kobo.685.2">Controlling is done by sending signals to the process using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.686.1">nginx -</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.687.1">s</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.688.1"> command:</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-1">
<colgroup>
<col/>
<col/>
</colgroup>
<thead>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.689.1">Command</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.690.1">Description</span></strong></span></p>
</td>
</tr>
</thead>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.691.1">nginx -</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.692.1">s stop</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.693.1">Stops the daemon immediately (using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.694.1">TERM</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.695.1"> signal)</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.696.1">nginx -</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.697.1">s quit</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.698.1">Stops the daemon gracefully (using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.699.1">QUIT</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.700.1"> signal)</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.701.1">nginx -</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.702.1">s reopen</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.703.1">Reopens </span><span class="No-Break"><span class="koboSpan" id="kobo.704.1">log files</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="source-inline"><span class="koboSpan" id="kobo.705.1">nginx -</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.706.1">s reload</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.707.1">Reloads </span><span class="No-Break"><span class="koboSpan" id="kobo.708.1">the configuration</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.709.1"> Table 1.1: A table to remember how to control the nginx daemon</span></p>
<p><span class="koboSpan" id="kobo.710.1">When starting</span><a id="_idIndexMarker059"/><span class="koboSpan" id="kobo.711.1"> the daemon, stopping it, or performing any of the preceding operations, the configuration file is first parsed and verified. </span><span class="koboSpan" id="kobo.711.2">If the </span><a id="_idIndexMarker060"/><span class="koboSpan" id="kobo.712.1">configuration is invalid, whatever command you have submitted will </span><em class="italic"><span class="koboSpan" id="kobo.713.1">fail</span></em><span class="koboSpan" id="kobo.714.1">, even when trying to stop the daemon. </span><span class="koboSpan" id="kobo.714.2">In other words, in some cases, you will not be able to even stop NGINX if the configuration file </span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">is invalid.</span></span></p>
<p><span class="koboSpan" id="kobo.716.1">An alternate way to terminate the process, in desperate cases only, is to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.717.1">kill</span></strong><span class="koboSpan" id="kobo.718.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">killall</span></strong><span class="koboSpan" id="kobo.720.1"> commands with </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.721.1">root</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.722.1"> privileges:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.723.1">
[root@server ~]# killall ngi</span><a id="_idTextAnchor095"/><span class="koboSpan" id="kobo.724.1">n</span><a id="_idTextAnchor096"/><span class="koboSpan" id="kobo.725.1">x</span></pre> <h2 id="_idParaDest-39"><a id="_idTextAnchor097"/><span class="koboSpan" id="kobo.726.1">Testing the configuration</span></h2>
<p><span class="koboSpan" id="kobo.727.1">As you </span><a id="_idIndexMarker061"/><span class="koboSpan" id="kobo.728.1">can imagine, this tiny bit of detail might become an important issue if you constantly tweak your configuration. </span><span class="koboSpan" id="kobo.728.2">The slightest mistake in any of the configuration files can result in a loss of control over the service—you are then unable to stop it via regular </span><strong class="source-inline"><span class="koboSpan" id="kobo.729.1">init</span></strong><span class="koboSpan" id="kobo.730.1"> control commands, and obviously, it will refuse to </span><span class="No-Break"><span class="koboSpan" id="kobo.731.1">start again.</span></span></p>
<p><span class="koboSpan" id="kobo.732.1">In consequence, the following command will be useful to you on many occasions. </span><span class="koboSpan" id="kobo.732.2">It allows you to check the syntax, validity, and integrity of </span><span class="No-Break"><span class="koboSpan" id="kobo.733.1">your configuration:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.734.1">
[user@server ~]$ /usr/local/nginx/sbin/nginx -t</span></pre> <p><span class="koboSpan" id="kobo.735.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.736.1">-t</span></strong><span class="koboSpan" id="kobo.737.1"> switch stands for </span><strong class="bold"><span class="koboSpan" id="kobo.738.1">test configuration</span></strong><span class="koboSpan" id="kobo.739.1">. </span><span class="koboSpan" id="kobo.739.2">NGINX will parse the configuration anew and let you know whether it is valid or not. </span><span class="koboSpan" id="kobo.739.3">A valid configuration file does not necessarily mean NGINX will start though as there might be additional problems such as socket issues, invalid paths, or incorrect </span><span class="No-Break"><span class="koboSpan" id="kobo.740.1">access permissions.</span></span></p>
<p><span class="koboSpan" id="kobo.741.1">Obviously, manipulating your configuration files while your server is in production is a dangerous thing to do and should be avoided when possible. </span><span class="koboSpan" id="kobo.741.2">The best practice, in this case, is to place your new configuration into a separate temporary file and run the test on that file. </span><span class="koboSpan" id="kobo.741.3">NGINX makes it possible by offering the </span><strong class="source-inline"><span class="koboSpan" id="kobo.742.1">-</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.743.1">c</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.744.1"> switch:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.745.1">
[user@server sbin]$ ./nginx -t -c /home/user/test.conf</span></pre> <p><span class="koboSpan" id="kobo.746.1">This command will parse </span><strong class="source-inline"><span class="koboSpan" id="kobo.747.1">/home/user/test.conf</span></strong><span class="koboSpan" id="kobo.748.1"> and make sure it is a valid NGINX configuration file. </span><span class="koboSpan" id="kobo.748.2">When you are done, after making sure that your new file is valid, proceed to replace </span><a id="_idIndexMarker062"/><span class="koboSpan" id="kobo.749.1">your current configuration file and reload the </span><span class="No-Break"><span class="koboSpan" id="kobo.750.1">server configuration:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.751.1">
[user@server sbin]$ cp -i /home/user/test.conf usr/local/nginx/conf/nginx.conf
cp: erase 'nginx.conf' ? </span><span class="koboSpan" id="kobo.751.2">yes
[user@server sbin]$ ./nginx -s re</span><a id="_idTextAnchor098"/><span class="koboSpan" id="kobo.752.1">l</span><a id="_idTextAnchor099"/><span class="koboSpan" id="kobo.753.1">oad</span></pre> <h2 id="_idParaDest-40"><a id="_idTextAnchor100"/><span class="koboSpan" id="kobo.754.1">Other switches</span></h2>
<p><span class="koboSpan" id="kobo.755.1">Another</span><a id="_idIndexMarker063"/><span class="koboSpan" id="kobo.756.1"> switch that might come in handy in many situations is </span><strong class="source-inline"><span class="koboSpan" id="kobo.757.1">-V</span></strong><span class="koboSpan" id="kobo.758.1">. </span><span class="koboSpan" id="kobo.758.2">Not only does it tell you the current NGINX build version but, more importantly, it also reminds you about the arguments that you used during the configuration step – in other words, the command switches that you passed to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.759.1">configure</span></strong><span class="koboSpan" id="kobo.760.1"> script </span><span class="No-Break"><span class="koboSpan" id="kobo.761.1">before compilation:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.762.1">
[user@server sbin]$ ./nginx -V
nginx version: nginx/1.25.2 (Ubuntu)
built by gcc 11.4.0 (Ubuntu 11.4.0-1ubuntu1~22.04)
TLS SNI support enabled
configure arguments: --with-http_ssl_module</span></pre> <p><span class="koboSpan" id="kobo.763.1">In this case, NGINX was configured with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.764.1">--with-http_ssl_module</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.765.1">switch only.</span></span></p>
<p><span class="koboSpan" id="kobo.766.1">Why is this so important? </span><span class="koboSpan" id="kobo.766.2">Well, if you ever try to use a module that was not included with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.767.1">configure</span></strong><span class="koboSpan" id="kobo.768.1"> script during the precompilation process, the directive enabling the module will result in a configuration error. </span><span class="koboSpan" id="kobo.768.2">Your first reaction will be to wonder where the syntax error comes from. </span><span class="koboSpan" id="kobo.768.3">Your second reaction will be to wonder if you even built the module in the first place! </span><span class="koboSpan" id="kobo.768.4">Running </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">nginx -V</span></strong><span class="koboSpan" id="kobo.770.1"> will answer </span><span class="No-Break"><span class="koboSpan" id="kobo.771.1">this question.</span></span></p>
<p><span class="koboSpan" id="kobo.772.1">Additionally, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.773.1">-g</span></strong><span class="koboSpan" id="kobo.774.1"> option lets you specify additional configuration directives, in case they were not included in the </span><span class="No-Break"><span class="koboSpan" id="kobo.775.1">configuration file:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.776.1">
[user@server sbin]$ ./nginx -g "timer_resolution 200</span><a id="_idTextAnchor101"/><span class="koboSpan" id="kobo.777.1">ms";</span></pre> <p><span class="koboSpan" id="kobo.778.1">In the next section, we will configure the daemon through the system to have NGINX integrated and running automatically on your </span><span class="No-Break"><span class="koboSpan" id="kobo.779.1">Linux distribut</span><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.780.1">ion.</span></span></p>
<h1 id="_idParaDest-41"><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.781.1">Adding NGINX as a system service</span></h1>
<p><span class="koboSpan" id="kobo.782.1">In this section, we will create a script that will transform the NGINX daemon into an actual system service. </span><span class="koboSpan" id="kobo.782.2">This</span><a id="_idIndexMarker064"/><span class="koboSpan" id="kobo.783.1"> will result in mainly two outcomes—the daemon will be controllable using standard commands and, more importantly, it will automatically be launched on system startup and stopped on </span><span class="No-Break"><span class="koboSpan" id="kobo.784.1">system shu</span><a id="_idTextAnchor104"/><span class="koboSpan" id="kobo.785.1">t</span><a id="_idTextAnchor105"/><span class="koboSpan" id="kobo.786.1">down.</span></span></p>
<h2 id="_idParaDest-42"><a id="_idTextAnchor106"/><span class="koboSpan" id="kobo.787.1">systemd unit file</span></h2>
<p><span class="koboSpan" id="kobo.788.1">Most Linux-based</span><a id="_idIndexMarker065"/><span class="koboSpan" id="kobo.789.1"> operating systems to date use a systemd-style </span><em class="italic"><span class="koboSpan" id="kobo.790.1">service file</span></em><span class="koboSpan" id="kobo.791.1">. </span><span class="koboSpan" id="kobo.791.2">Debian, Ubuntu, RHEL, and centOS all use systemd nowadays; therefore, this service file should work on any popular linux distribution. </span><span class="koboSpan" id="kobo.791.3">There is other init software, such as System V and OpenRC; however, we will stick with the more popular and most </span><span class="No-Break"><span class="koboSpan" id="kobo.792.1">supported init.</span></span></p>
<p><span class="koboSpan" id="kobo.793.1">In this example, we will be using the NGINX service file provided by the official </span><span class="No-Break"><span class="koboSpan" id="kobo.794.1">NGINX website:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.795.1">Create a file by using the </span><span class="No-Break"><span class="koboSpan" id="kobo.796.1">following command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.797.1">nano /etc/systemd/system/nginx.service</span></strong></pre></li> </ol>
<div>
<div class="IMG---Figure" id="_idContainer012">
<span class="koboSpan" id="kobo.798.1"><img alt="Figure 1.3: Default systemd service file for Nginx" src="image/B21787_01_3.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.799.1">Figure 1.3: Default systemd service file for Nginx</span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.800.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.801.1">Make sure your paths are correct, as well as the  </span><strong class="source-inline"><span class="koboSpan" id="kobo.802.1">After=</span></strong><span class="koboSpan" id="kobo.803.1"> part which tells </span><strong class="source-inline"><span class="koboSpan" id="kobo.804.1">systemd</span></strong><span class="koboSpan" id="kobo.805.1"> to execute NGINX only after </span><strong class="source-inline"><span class="koboSpan" id="kobo.806.1">syslog.target</span></strong><span class="koboSpan" id="kobo.807.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.808.1">network-online.target</span></strong><span class="koboSpan" id="kobo.809.1">. </span><span class="koboSpan" id="kobo.809.2">Add your own services there, such as your database server, your PHP server, </span><span class="No-Break"><span class="koboSpan" id="kobo.810.1">and more.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.811.1">Once your</span><a id="_idIndexMarker066"/><span class="koboSpan" id="kobo.812.1"> file has been saved, reload the </span><strong class="source-inline"><span class="koboSpan" id="kobo.813.1">systemd</span></strong><span class="koboSpan" id="kobo.814.1"> configuration using </span><strong class="source-inline"><span class="koboSpan" id="kobo.815.1">systemctl daemon-reload</span></strong><span class="koboSpan" id="kobo.816.1">. </span><span class="koboSpan" id="kobo.816.2">Then, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">systemctl start nginx</span></strong><span class="koboSpan" id="kobo.818.1"> to start the service. </span><span class="koboSpan" id="kobo.818.2">You can start, stop, and restart the service in the same way. </span><span class="koboSpan" id="kobo.818.3">To enable the service at boot, run </span><span class="No-Break"><span class="koboSpan" id="kobo.819.1">the following:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.820.1">systemctl enabl</span><a id="_idTextAnchor107"/><span class="koboSpan" id="kobo.821.1">e nginx</span></strong></pre></li> <li><span class="koboSpan" id="kobo.822.1">To stop the NGINX server from booting automatically, you can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.823.1">disable</span></strong><span class="koboSpan" id="kobo.824.1"> instead of </span><strong class="source-inline"><span class="koboSpan" id="kobo.825.1">enable</span></strong><span class="koboSpan" id="kobo.826.1"> in the </span><span class="No-Break"><span class="koboSpan" id="kobo.827.1">preceding command.</span></span></li>
<li><span class="koboSpan" id="kobo.828.1">You can check whether your NGINX server will boot by running the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.829.1">is-enabled</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.830.1"> command:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.831.1">root@server:~# systemctl is-enabled nginx</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.832.1">e</span><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.833.1">nabled</span></strong></pre></li> </ol>
<h2 id="_idParaDest-43"><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.834.1">Handling system errors</span></h2>
<p><span class="koboSpan" id="kobo.835.1">Sometimes, you will encounter errors when starting NGINX with </span><strong class="source-inline"><span class="koboSpan" id="kobo.836.1">systemd</span></strong><span class="koboSpan" id="kobo.837.1">. </span><span class="koboSpan" id="kobo.837.2">Here is </span><span class="No-Break"><span class="koboSpan" id="kobo.838.1">an example:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer013">
<span class="koboSpan" id="kobo.839.1"><img alt="Figure 1.4: Debugging Nginx through systemd status" src="image/B21787_01_4.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.840.1">Figure 1.4: Debugging Nginx through systemd status</span></p>
<p><span class="koboSpan" id="kobo.841.1">In this case, you </span><a id="_idIndexMarker067"/><span class="koboSpan" id="kobo.842.1">check the current status using </span><strong class="source-inline"><span class="koboSpan" id="kobo.843.1">systemctl status nginx</span></strong><span class="koboSpan" id="kobo.844.1">. </span><span class="koboSpan" id="kobo.844.2">Most of the time, this tells you exactly why your NGINX server won’t start: very often, the NGINX configuration file is incorrect because of typos or forgotten characters. </span><span class="koboSpan" id="kobo.844.3">Make sure to double-check your configuration before restarting the </span><span class="No-Break"><span class="koboSpan" id="kobo.845.1">NGINX server.</span></span></p>
<p><span class="koboSpan" id="kobo.846.1">We have been diving into the compiling options for NGINX as well as its controlling daemon. </span><span class="koboSpan" id="kobo.846.2">Should you need professional support from the experts who have made NGINX what it is today, NGINX Plus might be </span><span class="No-Break"><span class="koboSpan" id="kobo.847.1">for </span><a id="_idTextAnchor110"/><a id="_idTextAnchor111"/><a id="_idTextAnchor112"/><a id="_idTextAnchor113"/><a id="_idTextAnchor114"/><a id="_idTextAnchor115"/><a id="_idTextAnchor116"/><span class="koboSpan" id="kobo.848.1">you.</span></span></p>
<h1 id="_idParaDest-44"><a id="_idTextAnchor117"/><span class="koboSpan" id="kobo.849.1">A quick overview of the possibilities offered by 
NGINX Plus</span></h1>
<p><span class="koboSpan" id="kobo.850.1">As of mid-2013, NGINX, Inc., the </span><a id="_idIndexMarker068"/><span class="koboSpan" id="kobo.851.1">company behind the NGINX project, also offers a paid subscription called NGINX Plus. </span><span class="koboSpan" id="kobo.851.2">The announcement came as a surprise for the open source community</span><a id="_idIndexMarker069"/><span class="koboSpan" id="kobo.852.1"> but several companies quickly jumped on the bandwagon and reported amazing improvements in terms of performance </span><span class="No-Break"><span class="koboSpan" id="kobo.853.1">and scalability.</span></span></p>
<p><span class="koboSpan" id="kobo.854.1">NGINX, Inc., the high-performance web company, today announced the availability of NGINX Plus, a fully-supported version of the popular NGINX open source software complete with advanced features and offered with professional services. </span><span class="koboSpan" id="kobo.854.2">The product is developed and supported by the core engineering team at </span><em class="italic"><span class="koboSpan" id="kobo.855.1">Nginx Inc.</span></em><span class="koboSpan" id="kobo.856.1">, and is available immediately on a </span><span class="No-Break"><span class="koboSpan" id="kobo.857.1">subscription basis.</span></span></p>
<p><span class="koboSpan" id="kobo.858.1">As business</span><a id="_idIndexMarker070"/><span class="koboSpan" id="kobo.859.1"> requirements continue to evolve rapidly, such as the shift to mobile and the explosion of dynamic content on the Web, CIOs are continuously looking for opportunities to increase application performance and development agility, while reducing dependencies on their infrastructure. </span><span class="koboSpan" id="kobo.859.2">NGINX Plus provides a flexible, scalable, uniformly applicable solution that was purpose built for these modern, distributed </span><span class="No-Break"><span class="koboSpan" id="kobo.860.1">application architectures.</span></span></p>
<p><span class="koboSpan" id="kobo.861.1">Considering the pricing plans ($1,500 per year per instance) and the additional features made available, this platform is indeed clearly aimed at large corporations looking to integrate NGINX into their global architecture seamlessly and effortlessly. </span><span class="koboSpan" id="kobo.861.2">Professional support from the NGINX team is included and discounts can be offered for multiple-instance subscriptions. </span><span class="koboSpan" id="kobo.861.3">This book covers the open source version of NGINX only and does not detail the advanced functionality offered by NGINX Plus. </span><span class="koboSpan" id="kobo.861.4">For more information about the paid subscription, take a look </span><span class="No-Break"><span class="koboSpan" id="kobo.862.1">at </span></span><a href="https://www.nginx.com/"><span class="No-Break"><span class="koboSpan" id="kobo.863.1">https://www.n</span><span id="_idTextAnchor118"/><span class="koboSpan" id="kobo.864.1">g</span><span id="_idTextAnchor119"/><span class="koboSpan" id="kobo.865.1">inx.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.866.1">.</span></span></p>
<h1 id="_idParaDest-45"><a id="_idTextAnchor120"/><span class="koboSpan" id="kobo.867.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.868.1">This chapter covered a number of critical steps. </span><span class="koboSpan" id="kobo.868.2">We first made sure that your system contained all the required components for compiling NGINX. </span><span class="koboSpan" id="kobo.868.3">We then proceeded to select the proper version branch for your usage – will you be using the stable version or a more advanced yet potentially less stable one? </span><span class="koboSpan" id="kobo.868.4">After downloading the source and configuring the compilation process by enabling or disabling features and modules such as SSL, GeoIP, and more, we compiled the application and installed it on the system in the directory of your choice. </span><span class="koboSpan" id="kobo.868.5">We created a </span><strong class="source-inline"><span class="koboSpan" id="kobo.869.1">unit service</span></strong><span class="koboSpan" id="kobo.870.1"> file and modified the system boot sequence to schedule the service to </span><span class="No-Break"><span class="koboSpan" id="kobo.871.1">be started.</span></span></p>
<p><span class="koboSpan" id="kobo.872.1">From this point on, NGINX is installed on your server and automatically starts with the system. </span><span class="koboSpan" id="kobo.872.2">Your web server is functional, though it does not yet answer the most basic functionality – serving a website. </span><span class="koboSpan" id="kobo.872.3">The first step toward hosting a website will be to prepare a suitable configuration file. </span><span class="koboSpan" id="kobo.872.4">The next chapter will cover the basic configuration of NGINX and will teach you how to optimize performance based on the expected audience and </span><span class="No-Break"><span class="koboSpan" id="kobo.873.1">system resources.</span></span></p>
</div>
</body></html>