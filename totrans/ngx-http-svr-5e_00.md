# 前言

NGINX 因其轻量级设计而闻名，是一款为处理高流量网站而设计的强大 HTTP 服务器，其主要目标是网络可扩展性。在我们日益互联的世界中，优化 Web 应用变得比以往任何时候都更为重要。无论你是初学者还是经验丰富的管理员，本书将引导你完成从快速基础配置到根据需求量身定制的更详细配置的整个过程。此新版聚焦于最新版本 1.25.2，新增了 HTTP/3 和 QUIC 等功能。

本书包含大量实际案例，将帮助你通过自动化 TLS 证书来保护你的基础设施，巧妙地将 NGINX 放置在现有应用前端，做更多的工作。你还将涉及编排、Docker、带宽管理、OpenResty 以及 NGINX Plus 的商业功能，以增强和优化你的基础设施或设计全新的架构。

本书结束时，你将能够适应并使用各种 NGINX 实现方式来解决你遇到的任何问题。

# 本书适合谁阅读

本版 NGINX 书籍精心设计，面向那些希望提高 Web 服务器管理理解的初学者 DevOps 工程师、系统管理员和网页开发者，特别是在性能优化和云基础设施方面。无论你是刚开始接触 Web 技术，还是希望巩固基础，本书都提供了有关 NGINX 的实用见解和动手实践经验，NGINX 是现代 Web 应用的核心。

本书的主要读者群体是初学者 DevOps 工程师、系统管理员和有好奇心的网页开发者。DevOps 新手将学习 NGINX 的基础知识，从设置到云优化，而系统管理员将获得有效部署和故障排除的策略，开发者则会发现如何通过提升性能、安全性和可扩展性来增强他们的项目。

# 本书内容概览

*第一章*，*下载和安装 NGINX*，是关于如何在你的系统上获取和配置 NGINX 的介绍。它涵盖了从初始下载到确保 NGINX 在重启后依然存在的所有基础知识，重点包括准备系统、配置 NGINX、管理动态加载的模块，并将 NGINX 集成为可靠的系统服务。本章最后介绍了 NGINX Plus。

*第二章*，*基本 NGINX 配置*，探讨了 NGINX 配置的基础知识，从文件语法和结构到测试变更。亮点包括配置语法、基本指令和服务器测试策略。

*第三章*，*探索 HTTP 配置*，专注于 NGINX HTTP 模块的复杂性，提供指令的全面指南和对 Location 块的深入探讨。从 HTTP 核心模块的基础知识，通过对指令和变量的深入讨论，到 Location 块的掌握，本章为读者提供了高效配置虚拟主机以及理解 NGINX 配置结构原理的知识。

*第四章*，*探索 NGINX 中的模块配置*，提供了 NGINX Rewrite 模块的深入指南，以及对开源版本的第一方模块的全面概述。本章侧重于通过 Rewrite 模块掌握“美化 URL”，并探索 NGINX 大量的附加模块。

*第五章*，*PHP 和 Python 与 NGINX*，强调通过 FastCGI 配置 NGINX 以与动态 PHP 和 Python 脚本配合工作。从深入探讨 FastCGI 原理开始，然后详细介绍配置 NGINX 以实现与 PHP 和 Python 应用的高效通信，并提供使用 FastCGI 模块进行最佳服务器端脚本集成的见解。

*第六章*，*NGINX 作为反向代理*，讨论了 NGINX 的反向代理能力，并深入探讨了 NGINX 代理模块的细节。读者将学习如何使用代理模块，欣赏 NGINX 在管理现代 Web 应用程序方面的优势，并高效设置反向代理配置。

*第七章*，*负载均衡和优化简介*，专注于部署 NGINX 以管理多服务器上的高流量网站。本章介绍了 NGINX 的高级负载均衡能力和最新的 I/O 优化功能，包括线程池的使用。提供了建立平衡服务器架构和改善 I/O 性能的全面指南，这对于大规模 Web 应用程序的可扩展性和效率至关重要。

*第八章*，*NGINX 在云基础设施中*，重点介绍了在云环境中使用 NGINX 和 Docker 的集成，从 Docker 基础知识到使用 Docker Compose 部署 NGINX。学习如何优化容器化应用程序以及如何将 NGINX 作为中心网关进行缓存。

*第九章*，*使用 Ansible 完全部署、管理和自动更新 NGINX*，探讨了使用 Ansible 在多服务器上高效部署 NGINX。涵盖了大规模部署策略、配置管理基础知识以及为 NGINX 编写 Ansible 角色的技巧，本章将帮助管理大规模服务器。最后介绍了自动化 NGINX 更新，以轻松维护并提供稳健安全的 NGINX 舰队。

*第十章*，*案例研究*，深入探讨了如何通过详细的案例研究部署安全的网站和应用程序。掌握使用 acme.sh 实现 SSL，采用 HTTP/2，配置 WordPress 并与 Docker 集成 NextCloud。掌握部署安全站点、为各种场景配置 NGINX 以及使用 NGINX 增强 Docker 环境的技能。

*第十一章*，*故障排除*，通过必备的技巧和工具帮助你进行 NGINX 调试，识别问题。涵盖了一般的故障排除建议、日志解析以及常见问题，如安装错误和 403 Forbidden 页面，本章为解决配置错误和理解阻塞优先级提供了清晰的路径。学习如何调整配置进行有效调试，并识别常见的 NGINX 配置错误。

# 为了最大化地从本书中受益

| **操作系统要求** | **本书涉及的软件/硬件** |
| --- | --- |
| Linux（最好是 Debian、Ubuntu、Fedora 或 RHEL） | NGINX |
|  | Ansible |
|  | Docker |

如果你使用的是本书的数字版，我们建议你自己输入代码，或者访问本书的 GitHub 仓库（下一个章节会提供链接）。这样可以避免复制粘贴代码时可能出现的错误。

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件，地址是[`github.com/PacktPublishing/NGINX-HTTP-Server_Fifth-edition`](https://github.com/PacktPublishing/NGINX-HTTP-Server_Fifth-edition)。如果代码有更新，它将会在 GitHub 仓库中更新。

我们还提供了来自丰富目录的其他代码包，您可以在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。快去看看吧！

# 使用的约定

本书中使用了若干文本约定。

`文本中的代码`：表示文本中的代码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 用户名。示例：“将下载的`WebStorm-10*.dmg`磁盘映像文件作为另一个磁盘挂载到系统中。”

一段代码设置如下：

```
[nginx] 
name=nginx repo 
baseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/ 
gpgcheck=0 
enabled=1
```

任何命令行输入或输出如下所示：

```
apt update 
apt install nginx
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词通常是**粗体**的。示例：“从**系统信息**选项中选择**管理**面板。”

提示或重要事项

以这种方式出现。

# 联系我们

我们欢迎读者的反馈。

**常规反馈**：如果你对本书的任何方面有疑问，请通过电子邮件联系我们，邮件地址是 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误**：尽管我们已尽力确保内容的准确性，但难免会有错误。如果您在本书中发现错误，我们将不胜感激您向我们报告。请访问[www.packtpub.com/support/errata](https://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上发现我们作品的任何非法复制品，请告知我们其所在位置或网站名称。请通过 copyright@packt.com 与我们联系，并提供相关链接。

**如果您有意成为作者**：如果您在某个领域具有专业知识，并且有兴趣写作或为一本书提供贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

阅读完*NGINX HTTP Server*后，我们希望听到您的想法！请[点击这里直接进入亚马逊评论页面](https://packt.link/r/1835469876)并分享您的反馈。

您的评论对我们以及技术社区都非常重要，能够帮助我们确保提供优质内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢随时阅读，但又无法随身携带纸质书籍吗？

您的电子书购买与您选择的设备不兼容吗？

不用担心，现在每本 Packt 书籍都可以免费获得该书的无 DRM PDF 版本。

随时随地，在任何设备上阅读。从您最喜欢的技术书籍中直接搜索、复制并粘贴代码到您的应用程序中。

特权不仅仅是这些，您还可以独享折扣、新闻简报以及每日发送到您邮箱的精彩免费内容。

按照以下简单步骤获取福利：

1.  扫描二维码或访问以下链接

![下载本书的免费 PDF 副本二维码](img/B21787_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781835469873`](https://packt.link/free-ebook/9781835469873)

1.  提交您的购买证明

1.  就这些！我们将直接将您的免费 PDF 和其他福利发送到您的电子邮件。

# 第一部分：从 NGINX 开始

在本部分中，您将了解 NGINX 的基础知识。本节通过探索 Web 服务器的安装和基本配置，为您提供理解 NGINX 及其功能的基础。您将获得有关 NGINX 高效配置的实用信息，为接下来的高级配置和优化技巧打下基础。

本部分包括以下章节：

+   *第一章*，*下载与安装 NGINX*

+   *第二章*，*基本 NGINX 配置*
